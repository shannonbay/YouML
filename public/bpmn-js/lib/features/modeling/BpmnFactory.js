import{map,assign,pick}from"min-dash";import{isAny}from"./util/ModelingUtil";import{is}from"../../util/ModelUtil";export default function BpmnFactory(t){this._model=t}BpmnFactory.$inject=["moddle"],BpmnFactory.prototype._needsId=function(t){return isAny(t,["bpmn:RootElement","bpmn:FlowElement","bpmn:MessageFlow","bpmn:DataAssociation","bpmn:Artifact","bpmn:Participant","bpmn:Lane","bpmn:LaneSet","bpmn:Process","bpmn:Collaboration","bpmndi:BPMNShape","bpmndi:BPMNEdge","bpmndi:BPMNDiagram","bpmndi:BPMNPlane","bpmn:Property","bpmn:CategoryValue"])},BpmnFactory.prototype._ensureId=function(t){var e;t.id?this._model.ids.claim(t.id,t):(e=is(t,"bpmn:Activity")?"Activity":is(t,"bpmn:Event")?"Event":is(t,"bpmn:Gateway")?"Gateway":isAny(t,["bpmn:SequenceFlow","bpmn:MessageFlow"])?"Flow":(t.$type||"").replace(/^[^:]*:/g,""),e+="_",!t.id&&this._needsId(t)&&(t.id=this._model.ids.nextPrefixed(e,t)))},BpmnFactory.prototype.create=function(t,e){var n=this._model.create(t,e||{});return this._ensureId(n),n},BpmnFactory.prototype.createDiLabel=function(){return this.create("bpmndi:BPMNLabel",{bounds:this.createDiBounds()})},BpmnFactory.prototype.createDiShape=function(t,e){return this.create("bpmndi:BPMNShape",assign({bpmnElement:t,bounds:this.createDiBounds()},e))},BpmnFactory.prototype.createDiBounds=function(t){return this.create("dc:Bounds",t)},BpmnFactory.prototype.createDiWaypoints=function(t){var e=this;return map(t,(function(t){return e.createDiWaypoint(t)}))},BpmnFactory.prototype.createDiWaypoint=function(t){return this.create("dc:Point",pick(t,["x","y"]))},BpmnFactory.prototype.createDiEdge=function(t,e){return this.create("bpmndi:BPMNEdge",assign({bpmnElement:t,waypoint:this.createDiWaypoints([])},e))},BpmnFactory.prototype.createDiPlane=function(t,e){return this.create("bpmndi:BPMNPlane",assign({bpmnElement:t},e))};