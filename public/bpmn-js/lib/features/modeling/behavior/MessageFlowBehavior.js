import inherits from"inherits-browser";import CommandInterceptor from"diagram-js/lib/command/CommandInterceptor";import{is}from"../../../util/ModelUtil";import{isExpanded}from"../../../util/DiUtil";import{selfAndAllChildren}from"diagram-js/lib/util/Elements";import{getResizedSourceAnchor,getResizedTargetAnchor}from"diagram-js/lib/features/modeling/cmd/helper/AnchorsHelper";export default function MessageFlowBehavior(e,i){CommandInterceptor.call(this,e),this.postExecute("shape.replace",(function(e){var n=e.oldShape,o=e.newShape;if(isParticipantCollapse(n,o)){var r=getMessageFlows(n);r.incoming.forEach((function(e){var r=getResizedTargetAnchor(e,o,n);i.reconnectEnd(e,o,r)})),r.outgoing.forEach((function(e){var r=getResizedSourceAnchor(e,o,n);i.reconnectStart(e,o,r)}))}}),!0)}function isParticipantCollapse(e,i){return is(e,"bpmn:Participant")&&isExpanded(e)&&is(i,"bpmn:Participant")&&!isExpanded(i)}function getMessageFlows(e){var i=selfAndAllChildren([e],!1),n=[],o=[];return i.forEach((function(i){i!==e&&(i.incoming.forEach((function(e){is(e,"bpmn:MessageFlow")&&n.push(e)})),i.outgoing.forEach((function(e){is(e,"bpmn:MessageFlow")&&o.push(e)})))}),[]),{incoming:n,outgoing:o}}MessageFlowBehavior.$inject=["eventBus","modeling"],inherits(MessageFlowBehavior,CommandInterceptor);