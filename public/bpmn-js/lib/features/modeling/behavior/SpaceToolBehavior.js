import{forEach}from"min-dash";import{is}from"../../../util/ModelUtil";import{isExpanded,isHorizontal}from"../../../util/DiUtil";import{GROUP_MIN_DIMENSIONS,LANE_MIN_DIMENSIONS,VERTICAL_LANE_MIN_DIMENSIONS,PARTICIPANT_MIN_DIMENSIONS,VERTICAL_PARTICIPANT_MIN_DIMENSIONS,SUB_PROCESS_MIN_DIMENSIONS,TEXT_ANNOTATION_MIN_DIMENSIONS}from"./ResizeBehavior";import{getChildLanes}from"../util/LaneUtil";var max=Math.max;export default function SpaceToolBehavior(i){i.on("spaceTool.getMinDimensions",(function(i){var t=i.shapes,n=i.axis,I=i.start,e={};return forEach(t,(function(i){var t=i.id;is(i,"bpmn:Participant")&&(e[t]=getParticipantMinDimensions(i,n,I)),is(i,"bpmn:Lane")&&(e[t]=isHorizontal(i)?LANE_MIN_DIMENSIONS:VERTICAL_LANE_MIN_DIMENSIONS),is(i,"bpmn:SubProcess")&&isExpanded(i)&&(e[t]=SUB_PROCESS_MIN_DIMENSIONS),is(i,"bpmn:TextAnnotation")&&(e[t]=TEXT_ANNOTATION_MIN_DIMENSIONS),is(i,"bpmn:Group")&&(e[t]=GROUP_MIN_DIMENSIONS)})),e}))}function isHorizontalAxis(i){return"x"===i}function getParticipantMinDimensions(i,t,n){var I=isHorizontal(i);if(!hasChildLanes(i))return I?PARTICIPANT_MIN_DIMENSIONS:VERTICAL_PARTICIPANT_MIN_DIMENSIONS;var e=isHorizontalAxis(t);return e?I?PARTICIPANT_MIN_DIMENSIONS:{width:getParticipantMinWidth(i,n,e),height:VERTICAL_PARTICIPANT_MIN_DIMENSIONS.height}:I?{width:PARTICIPANT_MIN_DIMENSIONS.width,height:getParticipantMinHeight(i,n,e)}:VERTICAL_PARTICIPANT_MIN_DIMENSIONS}function getParticipantMinHeight(i,t,n){var I;return I=getLanesMinHeight(i,t,n),max(PARTICIPANT_MIN_DIMENSIONS.height,I)}function getParticipantMinWidth(i,t,n){var I;return I=getLanesMinWidth(i,t,n),max(VERTICAL_PARTICIPANT_MIN_DIMENSIONS.width,I)}function hasChildLanes(i){return!!getChildLanes(i).length}function getLanesMinHeight(i,t,n){var I;return I=findResizedLane(getChildLanes(i),t,n),i.height-I.height+LANE_MIN_DIMENSIONS.height}function getLanesMinWidth(i,t,n){var I;return I=findResizedLane(getChildLanes(i),t,n),i.width-I.width+VERTICAL_LANE_MIN_DIMENSIONS.width}function findResizedLane(i,t,n){var I,e,N;for(I=0;I<i.length;I++)if(e=i[I],!n&&t>=e.y&&t<=e.y+e.height||n&&t>=e.x&&t<=e.x+e.width)return(N=getChildLanes(e)).length?findResizedLane(N,t,n):e}SpaceToolBehavior.$inject=["eventBus"];