import inherits from"inherits-browser";import{is}from"../../../util/ModelUtil";import CommandInterceptor from"diagram-js/lib/command/CommandInterceptor";import lineIntersect from"./util/LineIntersect";export default function RemoveElementBehavior(e,n,t){CommandInterceptor.call(this,e),this.preExecute("shape.delete",(function(e){var o=e.context.shape;if(1===o.incoming.length&&1===o.outgoing.length){var i=o.incoming[0],r=o.outgoing[0];if(is(i,"bpmn:SequenceFlow")&&is(r,"bpmn:SequenceFlow")&&n.canConnect(i.source,r.target,i)){var c=getNewWaypoints(i.waypoints,r.waypoints);t.reconnectEnd(i,r.target,c)}}}))}function getDocking(e){return e.original||e}function getNewWaypoints(e,n){var t=lineIntersect(getDocking(e[e.length-2]),getDocking(e[e.length-1]),getDocking(n[1]),getDocking(n[0]));return t?[].concat(e.slice(0,e.length-1),[t],n.slice(1)):[getDocking(e[0]),getDocking(n[n.length-1])]}inherits(RemoveElementBehavior,CommandInterceptor),RemoveElementBehavior.$inject=["eventBus","bpmnRules","modeling"];