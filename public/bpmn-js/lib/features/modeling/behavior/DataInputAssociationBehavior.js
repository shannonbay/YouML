import inherits from"inherits-browser";import CommandInterceptor from"diagram-js/lib/command/CommandInterceptor";import{add as collectionAdd,remove as collectionRemove}from"diagram-js/lib/util/Collections";import{find}from"min-dash";import{is}from"../../../util/ModelUtil";var TARGET_REF_PLACEHOLDER_NAME="__targetRef_placeholder";export default function DataInputAssociationBehavior(t,n){function e(t,e){var o=t.get("properties"),i=find(o,(function(t){return t.name===TARGET_REF_PLACEHOLDER_NAME}));return!i&&e&&(i=n.create("bpmn:Property",{name:TARGET_REF_PLACEHOLDER_NAME}),collectionAdd(o,i)),i}function o(t,n){var o=e(t);o&&(function(t,n,e){var o=t.get("dataInputAssociations");return find(o,(function(t){return t!==e&&t.targetRef===n}))}(t,o,n)||collectionRemove(t.get("properties"),o))}function i(t){var n,i=t.context,r=i.connection,c=r.businessObject,a=r.target,s=a&&a.businessObject,u=i.newTarget,m=u&&u.businessObject,p=i.oldTarget||i.target,d=p&&p.businessObject,f=r.businessObject;d&&d!==s&&o(d,c),m&&m!==s&&o(m,c),s?(n=e(s,!0),f.targetRef=n):f.targetRef=null}CommandInterceptor.call(this,t),this.executed(["connection.create","connection.delete","connection.move","connection.reconnect"],ifDataInputAssociation(i)),this.reverted(["connection.create","connection.delete","connection.move","connection.reconnect"],ifDataInputAssociation(i))}function ifDataInputAssociation(t){return function(n){var e=n.context.connection;if(is(e,"bpmn:DataInputAssociation"))return t(n)}}DataInputAssociationBehavior.$inject=["eventBus","bpmnFactory"],inherits(DataInputAssociationBehavior,CommandInterceptor);