import{domify,classes}from"min-dom";import{find}from"min-dash";import{escapeHTML}from"diagram-js/lib/util/EscapeUtil";import{getBusinessObject,is}from"../../util/ModelUtil";import{getPlaneIdFromShape}from"../../util/DrilldownUtil";var OPEN_CLASS="bjs-breadcrumbs-shown";export default function DrilldownBreadcrumbs(e,n,t){var i=domify('<ul class="bjs-breadcrumbs"></ul>'),r=t.getContainer(),s=classes(r);r.appendChild(i);var o=[];function a(e){e&&(o=getBusinessObjectParentChain(e));var r=o.flatMap((function(e){var i=t.findRoot(getPlaneIdFromShape(e))||t.findRoot(e.id);if(!i&&is(e,"bpmn:Process")){var r=n.find((function(n){var t=getBusinessObject(n);return t&&t.get("processRef")===e}));i=r&&t.findRoot(r.id)}if(!i)return[];var s=escapeHTML(e.name||e.id),o=domify('<li><span class="bjs-crumb"><a title="'+s+'">'+s+"</a></span></li>");return o.addEventListener("click",(function(){t.setRootElement(i)})),o}));i.innerHTML="";var a=r.length>1;s.toggle(OPEN_CLASS,a),r.forEach((function(e){i.appendChild(e)}))}e.on("element.changed",(function(e){var n=e.element,t=getBusinessObject(n);find(o,(function(e){return e===t}))&&a()})),e.on("root.set",(function(e){a(e.element)}))}function getBusinessObjectParentChain(e){for(var n=[],t=getBusinessObject(e);t;t=t.$parent)(is(t,"bpmn:SubProcess")||is(t,"bpmn:Process"))&&n.push(t);return n.reverse()}DrilldownBreadcrumbs.$inject=["eventBus","elementRegistry","canvas"];