import{setLabel,getLabel}from"../../../util/LabelUtil";import{getExternalLabelMid,isLabelExternal,hasExternalLabel,isLabel}from"../../../util/LabelUtil";import{is}from"../../../util/ModelUtil";var NULL_DIMENSIONS={width:0,height:0};export default function UpdateLabelHandler(e,t,l){function a(e,t){var l=e.label||e,a=e.labelTarget||e;return setLabel(l,t,a!==l),[l,a]}this.preExecute=function(t){var l=t.element,a=l.businessObject,i=t.newLabel;if(!isLabel(l)&&isLabelExternal(l)&&!hasExternalLabel(l)&&!isEmptyText(i)){var n=getExternalLabelMid(l);n={x:n.x,y:n.y+7},e.createLabel(l,n,{id:a.id+"_label",businessObject:a,di:l.di})}},this.execute=function(e){return e.oldLabel=getLabel(e.element),a(e.element,e.newLabel)},this.revert=function(e){return a(e.element,e.oldLabel)},this.postExecute=function(l){var a=l.element,i=a.label||a,n=l.newLabel,r=l.newBounds,b=l.hints||{};if(isLabel(i)||is(i,"bpmn:TextAnnotation"))if(isLabel(i)&&isEmptyText(n))!1!==b.removeShape&&e.removeShape(i,{unsetLabel:!1});else{var s=getLabel(a);void 0===r&&(r=t.getExternalLabelBounds(i,s)),r&&e.resizeShape(i,r,NULL_DIMENSIONS)}}}function isEmptyText(e){return!e||!e.trim()}UpdateLabelHandler.$inject=["modeling","textRenderer","bpmnFactory"];